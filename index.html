<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CÃ¡ritas CNC</title>

  <!-- ====== Estilos propios ====== -->
  <link rel="stylesheet" href="styles.css?v=6" />

  <!-- ====== LibrerÃ­as externas ====== -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" defer></script>

  <!-- ====== FullCalendar ====== -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js" defer></script>

  <!-- ====== LibrerÃ­a QR ====== -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js" defer></script>

  <!-- ====== Manifest y Service Worker ====== -->
  <link rel="manifest" href="manifest.json" />

  <!-- ====== Firebase ====== -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>

  <!-- ====== Supabase ====== -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="./supabase-config.js"></script>
</head>
<body>
  <!-- ================== Header ================== -->
  <header class="app-header">
    <h1>ğŸ“Œ CÃ¡ritas CNC</h1>
    <nav>
      <button onclick="mostrarSeccion('inicio')">ğŸ  Inicio</button>
      <button onclick="mostrarSeccion('registro-fam')">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Registro Familias</button>
      <button onclick="mostrarSeccion('servicios')">âš™ï¸ Servicios</button>
    </nav>
  </header>

  <!-- ================== SecciÃ³n: Inicio ================== -->
  <section id="inicio" class="seccion active">
    <div class="inicio-card">
      <h2>Bienvenido</h2>
      <p>Plataforma <b>CÃ¡ritas CNC</b> - GestiÃ³n de Familias y Credenciales.</p>
    </div>
  </section>

  <!-- ================== SecciÃ³n: Registro Familias ================== -->
  <section id="registro-fam" class="seccion">
    <h2>ğŸ“‹ Registro de Familias</h2>
    <form id="familiaForm" enctype="multipart/form-data" class="card">
      <label>Nombres y Apellidos*</label>
      <input type="text" name="nombres_apellidos" required />

      <label>DNI*</label>
      <input type="text" name="dni_solicitante" maxlength="8" pattern="[0-9]{8}" required />

      <label>Apellido Familia*</label>
      <input type="text" name="apellido_familia" required />

      <label>DirecciÃ³n* (con sugerencias)</label>
      <div class="row">
        <input type="text" id="reg-direccion" name="direccion" list="dl-direcciones" autocomplete="off" required />
      </div>
      <datalist id="dl-direcciones"></datalist>

      <label>Fecha de Registro*</label>
      <input type="date" name="fecha_registro" required />

      <label>TelÃ©fono*</label>
      <input type="text" name="telefono_contacto" pattern="[0-9]+" required />

      <label>Observaciones</label>
      <textarea name="observaciones"></textarea>

      <label>Adjuntar documento</label>
      <input type="file" name="archivo" accept=".pdf,.jpg,.png" />

      <label>
        <input type="checkbox" required>
        Acepto los <a href="terminos.html" target="_blank">tÃ©rminos y condiciones</a>
      </label>

      <button type="submit" class="submit-btn">Guardar Familia</button>
    </form>

    <!-- Contenedor para el mapa -->
    <div id="map" style="height:300px; margin-top:10px;"></div>
  </section>
  
  <!-- ================== SecciÃ³n: Servicios ================== -->
  <section id="servicios" class="seccion">
    <h2>âš™ï¸ Servicios</h2>
    <div class="card">
      <p>Selecciona un mÃ³dulo:</p>
      <details>
        <summary>ğŸªª Credenciales</summary>
        <div>
          <form id="credencialForm">
            <label>Correo*</label>
            <input type="email" id="email" required />

            <label>ContraseÃ±a*</label>
            <input type="password" id="password" required />

            <label>Foto*</label>
            <input type="file" id="foto" accept="image/*" required />

            <button type="submit">Generar Credencial</button>
          </form>
          <div id="credencialPreview" class="preview"></div>
        </div>
      </details>

      <details>
        <summary>ğŸ“… Calendario</summary>
        <div id="calendar"></div>
      </details>

      <details>
        <summary>ğŸ“‹ Pendientes</summary>
        <div>
          <form id="pendienteForm">
            <input type="text" id="pendienteInput" placeholder="Escribe un pendiente..." required />
            <button type="submit">â• Agregar</button>
          </form>
          <ul id="pendientesList"></ul>
        </div>
      </details>
    </div>
  </section>

  <!-- ================== Scripts propios ================== -->
  <script>
    // Manejo de navegaciÃ³n de secciones
    function mostrarSeccion(id) {
      document.querySelectorAll(".seccion").forEach(sec => sec.classList.remove("active"));
      document.getElementById(id).classList.add("active");
    }
  </script>

  <script src="./login-supabase.js" defer></script>
  <script src="./credenciales.js" defer></script>
  <script src="./familias.js" defer></script>
  <script src="./servicios.js" defer></script>
  <script src="./calendario.js" defer></script>
  <script src="./pendientes.js" defer></script>
</body>
</html>
