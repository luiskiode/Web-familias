<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CÃ¡ritas CNC</title>

  <!-- ====== Estilos propios ====== -->
  <link rel="stylesheet" href="styles.css?v=8" />

  <!-- ====== FullCalendar ====== -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js" defer></script>

  <!-- ====== LibrerÃ­a QR ====== -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js" defer></script>

  <!-- ====== Manifest ====== -->
  <link rel="manifest" href="manifest.json" />

  <!-- ====== Firebase (compat) ====== -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>

  <!-- ====== Supabase ====== -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="./supabase-config.js"></script>
</head>
<body>

  <!-- ğŸ¥ Video de fondo -->
<video autoplay muted loop playsinline id="video-fondo">
  <source src="fondo-rojo.mp4" type="video/mp4">
  Tu navegador no soporta video en HTML5.
</video>

  <!-- ================== Header ================== -->
  <header class="app-header">
    <h1>ğŸ“Œ CÃ¡ritas CNC</h1>
    <nav>
      <button onclick="mostrarSeccion('inicio')">ğŸ  Inicio</button>
      <button onclick="mostrarSeccion('registro-fam')">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Registro Familias</button>
      <button onclick="mostrarSeccion('servicios')">âš™ï¸ Servicios</button>
    </nav>
  </header>

<!-- ================== SecciÃ³n: Inicio ================== -->
<section id="inicio" class="seccion active">
  <div class="inicio-card">

    <!-- Contenedor principal para todo el inicio -->
    <div class="inicio-contenido">

      <!-- Bienvenida personalizada -->
      <h2 id="bienvenida">ğŸ‘‹ Bienvenido a CÃ¡ritas CNC â¤ï¸</h2>
      <p id="mensajeInicio"><p>Esta es la plataforma de gestiÃ³n para el voluntariado de CÃ¡ritas CNC.</p>
          <p>Desde aquÃ­ puedes registrar nuevas familias, gestionar tareas internas y acceder a la agenda del grupo.</p>
</p>

      <!-- Pendientes en texto -->
      <div class="pendientes-bloque">
        <h3>ğŸ“Œ Resumen de pendientes</h3>
        <p id="pendientesTexto">Los pendientes son: (sin pendientes aÃºn)</p>
        <button class="btn-peque" onclick="mostrarSeccion('servicios')">Ver mÃ¡s â</button>
      </div>

      <!-- Acciones rÃ¡pidas -->
      <div class="quick-actions">
        <button class="btn-peque" onclick="alert('ğŸ‘‰ SecciÃ³n de donaciones prÃ³ximamente')">ğŸ’– Donaciones</button>
        <button class="btn-peque" onclick="alert('ğŸ‘‰ SecciÃ³n de patrocinio prÃ³ximamente')">ğŸ¤ Patrocinio</button>
      </div>

     <!-- MisiÃ³n y VisiÃ³n estilizadas -->
<div class="mision-vision">
  <div class="mision">
    <h3>ğŸŒŸ Nuestra MisiÃ³n</h3>
    <ul>
      <li>ğŸ’– Servir con amor, respeto y empatÃ­a a las familias mÃ¡s necesitadas.</li>
      <li>ğŸ™ Guiarnos por la fe, el compromiso y la compasiÃ³n para acompaÃ±ar, escuchar y brindar apoyo.</li>
      <li>ğŸ¤ Promover dignidad, justicia y solidaridad en nuestra comunidad.</li>
      <li>ğŸŒ± Trabajar unidos para construir oportunidades de desarrollo y esperanza.</li>
      <li>ğŸ”¥ Transformar vidas a travÃ©s de la acciÃ³n social y el amor al prÃ³jimo.</li>
    </ul>
  </div>

  <div class="vision">
    <h3>ğŸš€ Nuestra VisiÃ³n</h3>
    <ul>
      <li>ğŸ› Ser un referente de servicio y apoyo a familias en situaciÃ³n de vulnerabilidad.</li>
      <li>ğŸ’¡ Construir una comunidad justa, fraterna y solidaria donde cada persona sea valorada.</li>
      <li>âœ Inspirarnos en el Evangelio para transformar realidades con amor, fe y servicio.</li>
      <li>ğŸŒ Promover justicia social y desarrollo integral de cada persona.</li>
      <li>ğŸ¤— AcompaÃ±ar a cada familia para que encuentre en CÃ¡ritas CNC un lugar de acogida y transformaciÃ³n.</li>
    </ul>
  </div>

  <p class="agradecimiento">ğŸ™ Â¡Gracias por ser parte de esta misiÃ³n!</p>
  <p class="agradecimiento"><b>Gracias por usar CÃ¡ritas CNC</b></p>
</div>


      <!-- GalerÃ­a lateral -->
      <div class="galeria">
        <h3>ğŸ“· Nuestra comunidad</h3>
        <div class="galeria-grid">
          <img src="img/imagen de grupo 1.jpeg" alt="Imagen 1" class="miniatura">
          <img src="img/imagen de grupo 2.jpeg" alt="Imagen 2" class="miniatura">
          <img src="img/imagen de grupo 3.jpeg" alt="Imagen 3" class="miniatura">
          <img src="img/imagen de grupo 4.jpeg" alt="Imagen 4" class="miniatura">
          <img src="img/imagen de grupo 5.jpeg" alt="Imagen 5" class="miniatura">
        </div>
      </div>
     
    </div> <!-- fin inicio-contenido -->

  </div> <!-- fin inicio-card -->
</section>

<!-- Modal para imagen grande -->
<div id="modal" class="modal">
  <span class="cerrar">&times;</span>
  <img class="modal-contenido" id="img-ampliada">
  <div id="caption"></div>
</div>


  <!-- ================== SecciÃ³n: Registro Familias ================== -->
  <section id="registro-fam" class="seccion">
    <h2>ğŸ“‹ Registro de Familias</h2>
    <form id="familiaForm" enctype="multipart/form-data" class="card">
      <label>Nombres y Apellidos*</label>
      <input type="text" name="nombres_apellidos" required />

      <label>DNI*</label>
      <input type="text" name="dni_solicitante" maxlength="8" pattern="[0-9]{8}" required />

      <label>Apellido Familia*</label>
      <input type="text" name="apellido_familia" required />

      <label>DirecciÃ³n* (con sugerencias)</label>
      <div class="row" style="gap:.5rem; align-items:center;">
        <input type="text" id="reg-direccion" name="direccion" list="dl-direcciones" autocomplete="off" required />
        <button type="button" onclick="abrirMapa()" class="map-btn">ğŸ“ Validar</button>
      </div>
      <datalist id="dl-direcciones"></datalist>

      <label>Fecha de Registro*</label>
      <input type="date" name="fecha_registro" required />

      <label>TelÃ©fono*</label>
      <input type="text" name="telefono_contacto" pattern="[0-9]+" required />

      <label>Observaciones</label>
      <textarea name="observaciones"></textarea>

      <label>Adjuntar documento</label>
      <input type="file" name="archivo" accept=".pdf,.jpg,.png" />

      <label>
        <input type="checkbox" required>
        Acepto los <a href="terminos.html" target="_blank">tÃ©rminos y condiciones</a>
      </label>

      <button type="submit" class="submit-btn">Guardar Familia</button>
    </form>
  </section>
  
  <!-- ================== SecciÃ³n: Servicios ================== -->
<section id="servicios" class="seccion">
  <h2>âš™ï¸ Servicios</h2>
  
  <div class="servicios-grid">
    
    <!-- Credenciales -->
    <div class="servicio-card">
      <h3>ğŸªª Credenciales</h3>
      <p>Gestiona las credenciales de usuarios y voluntarios de manera rÃ¡pida y segura.</p>
      <form id="credencialForm" class="form-servicio">
        <input type="email" id="email" placeholder="Correo*" required />
        <input type="password" id="password" placeholder="ContraseÃ±a*" required />
        <input type="file" id="foto" accept="image/*" required />
        <button type="submit">Generar Credencial</button>
      </form>
      <div id="credencialPreview" class="preview"></div>
    </div>
    
    <!-- Calendario -->
    <div class="servicio-card">
      <h3>ğŸ“… Calendario</h3>
      <p>Visualiza y gestiona eventos de la comunidad, reuniones y actividades.</p>
      <div id="calendar"></div>
    </div>

    <!-- Pendientes -->
    <div class="servicio-card">
      <h3>ğŸ“‹ Pendientes</h3>
      <p>Agrega y revisa tareas pendientes vinculadas a tus actividades.</p>
      <form id="pendienteForm" class="form-servicio">
        <input type="text" id="pendienteInput" placeholder="Escribe un pendiente..." required />
        <button type="submit">â• Agregar</button>
      </form>
      <ul id="pendientesList"></ul>
    </div>

  </div>
</section>

  <!-- ================== InicializaciÃ³n Firebase (auth global) ================== -->
  <script>
    // âš ï¸ Reemplaza con tu propia config si cambia
    const firebaseConfig = {
      apiKey: "AIzaSyD5X6LUG_dOwuaUf6jQUHw_LM5PFgOmc40",
      authDomain: "web-familias.firebaseapp.com",
      projectId: "web-familias",
      storageBucket: "web-familias.firebasestorage.app",
      messagingSenderId: "261699620792",
      appId: "1:261699620792:web:8ff59afb72e96c371dc94d"
    };
    firebase.initializeApp(firebaseConfig);
    // Auth global para servicios.js
    window.auth = firebase.auth();
  </script>

  <!-- ================== Utilidades globales ================== -->
  <script>
    // NavegaciÃ³n por secciones
    function mostrarSeccion(id) {
      document.querySelectorAll(".seccion").forEach(sec => sec.classList.remove("active"));
      document.getElementById(id).classList.add("active");
    }

    // Abrir mapa en pestaÃ±a nueva con la direcciÃ³n
    function abrirMapa() {
      const direccion = document.getElementById("reg-direccion").value.trim();
      const url = direccion 
        ? `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(direccion)}`
        : `https://www.google.com/maps/`;
      window.open(url, "_blank");
    }
  </script>

  <!-- ================== Scripts propios (defer para ejecutar tras parseo) ================== -->
  <script src="./login-supabase.js" defer></script>
  <script src="./credenciales.js" defer></script>
  <script src="./familias.js" defer></script>
  <script src="./servicios.js" defer></script>
  <script src="./calendario.js" defer></script>
  <script src="./pendientes.js" defer></script>

  

  <script>
  
  
  document.addEventListener("DOMContentLoaded", () => {
    // âœ… Bienvenida personalizada
    auth.onAuthStateChanged(user => {
      const bienvenida = document.getElementById("bienvenida");
      const mensajeInicio = document.getElementById("mensajeInicio");

      if (user) {
        bienvenida.textContent = `ğŸ‘‹ Bienvenido, ${user.email}`;
        mensajeInicio.textContent = "Gracias por apoyar a CÃ¡ritas CNC.";
      } else {
        bienvenida.textContent = "ğŸ‘‹ Bienvenido a CÃ¡ritas CNC";
        mensajeInicio.textContent = "Conectando familias, fe y comunidad.";
      }
    });

    // âœ… Pendientes como texto
    if (typeof renderPendientesInicioTexto === "function") {
      renderPendientesInicioTexto();
    }
  });
</script>
<script>
// ================== GALERÃA DE IMÃGENES ==================
const modal = document.getElementById("modal");
const modalImg = document.getElementById("img-ampliada");
const captionText = document.getElementById("caption");
const spanCerrar = document.getElementsByClassName("cerrar")[0];

// Cuando se hace click en cualquier miniatura
document.querySelectorAll(".miniatura").forEach(img => {
  img.addEventListener("click", () => {
    modal.style.display = "flex"; // se usa flex para centrar
    modalImg.src = img.src;
    captionText.innerHTML = img.alt;
  });
});

// Cerrar el modal al hacer click en la "x"
spanCerrar.onclick = function() {
  modal.style.display = "none";
};

// Cerrar modal al hacer click fuera de la imagen
modal.addEventListener("click", (e) => {
  if(e.target === modal) modal.style.display = "none";
});
</script>


</body>
</html>
