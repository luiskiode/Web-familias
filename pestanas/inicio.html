<section class="inicio-card" id="tab-inicio">
  <!-- ğŸ“ Mensaje semanal -->
  <div class="card" id="mensaje-semanal" style="margin-top:1rem">
    <h3 class="with-emoji" data-emoji="ğŸ“">Mensaje Semanal</h3>
    <p style="line-height:1.6">
      âœ¨ <strong>Queridos jÃ³venes</strong>, ustedes son la esperanza viva de una Iglesia en camino. Por eso les agradezco su presencia y su contribuciÃ³n a la vida del Cuerpo de Cristo. Y les pido: <em>no permitan que nos falte nunca el lÃ­o bueno que ustedes hacen</em>; el empuje que tienen, como el de un motor limpio y Ã¡gil; su modo original de vivir y anunciar la alegrÃ­a de JesÃºs Resucitado. ğŸ™ Rezo por ello; y ustedes tambiÃ©n, por favor, recen por mÃ­. â¤ï¸â€ğŸ”¥
    </p>
  </div>

  <!-- ğŸ“Œ Pendientes (solo lectura) -->
  <div class="card" style="margin:.8rem 0 1.2rem">
    <div style="display:flex;align-items:center;gap:.5rem;justify-content:space-between">
      <h3>ğŸ“Œ Mis pendientes</h3>
      <small class="pill">vista solo lectura</small>
    </div>
    <div id="pendientes-home-empty" class="muted" style="display:none;margin:.5rem 0">Sin pendientes aÃºn. âœ¨</div>
    <table aria-label="Tabla de pendientes" style="margin-top:.5rem">
      <thead><tr><th>Tarea</th><th style="width:120px">Estado</th></tr></thead>
      <tbody id="pendientesHomeBody"></tbody>
    </table>
  </div>

  <!-- ğŸŒŸ MisiÃ³n / ğŸš€ VisiÃ³n -->
  <div class="card">
    <div class="mision-vision">
      <div class="mision">
        <h3>ğŸŒŸ Nuestra MisiÃ³n</h3>
        <ul>
          <li>â¤ï¸ Servir con respeto y empatÃ­a a las familias mÃ¡s necesitadas.</li>
          <li>ğŸ™ Guiarnos por la fe, el compromiso y la compasiÃ³n.</li>
          <li>ğŸ¤ Promover dignidad, justicia y solidaridad.</li>
          <li>ğŸŒ± Trabajar unidos para crear oportunidades y esperanza.</li>
          <li>ğŸ”¥ Transformar vidas a travÃ©s de la acciÃ³n social.</li>
        </ul>
      </div>
      <div class="vision">
        <h3>ğŸš€ Nuestra VisiÃ³n</h3>
        <ul>
          <li>ğŸ› Ser referente de servicio y apoyo.</li>
          <li>ğŸ’¡ Construir una comunidad fraterna.</li>
          <li>âœ Inspirarnos en el Evangelio.</li>
          <li>ğŸŒ Promover justicia social y desarrollo integral.</li>
          <li>ğŸ¤— AcompaÃ±ar con acogida y transformaciÃ³n.</li>
        </ul>
      </div>
      <p class="agradecimiento">ğŸ™ Â¡Gracias por ser parte de esta misiÃ³n! â¤ï¸</p>
    </div>
  </div>

  <!-- ğŸ“· GalerÃ­a -->
  <div class="card" style="margin-top:1rem">
    <h3>ğŸ“· Nuestra comunidad</h3>
    <div class="galeria-grid">
      <img src="img/imagen de grupo 1.jpeg" alt="Imagen 1" class="miniatura" />
      <img src="img/imagen de grupo 2.jpeg" alt="Imagen 2" class="miniatura" />
      <img src="img/imagen de grupo 3.jpeg" alt="Imagen 3" class="miniatura" />
      <img src="img/imagen de grupo 4.jpeg" alt="Imagen 4" class="miniatura" />
      <img src="img/imagen de grupo 5.jpeg" alt="Imagen 5" class="miniatura" />
    </div>
  </div>

  <!-- ğŸ–¼ï¸ Modal galerÃ­a -->
  <div id="modal" class="modal" aria-hidden="true" role="dialog" aria-label="Imagen ampliada">
    <span class="cerrar" id="modalClose" aria-label="Cerrar">âœ–ï¸</span>
    <img class="modal-contenido" id="img-ampliada" alt="Vista ampliada" />
    <div id="caption" style="color:#fff; margin-top:.4rem"></div>
  </div>
</section>

<script>
/* ğŸ”§ Comportamiento de la pestaÃ±a Inicio (CÃ¡ritas) */
(function(){
  'use strict';

  // GalerÃ­a con modal
  const modal = document.getElementById('modal');
  if (modal){
    const modalImg = document.getElementById('img-ampliada');
    const modalClose = document.getElementById('modalClose');
    const caption = document.getElementById('caption');
    document.querySelectorAll('.galeria-grid img').forEach(img=>{
      img.addEventListener('click', ()=>{
        modal.style.display='flex';
        modal.setAttribute('aria-hidden','false');
        modalImg.src = img.src;
        caption.textContent = img.alt || '';
      });
    });
    modalClose.addEventListener('click', ()=>{ modal.style.display='none'; modal.setAttribute('aria-hidden','true'); });
    modal.addEventListener('click', (e)=>{ if(e.target===modal) modalClose.click(); });
    window.addEventListener('keydown', (e)=>{ if(e.key==='Escape') modalClose.click(); });
  }

  // Pendientes (solo lectura) â€” usa Supabase de CÃRITAS en la shell
  async function renderPendientesHome(){
    const tbody = document.getElementById('pendientesHomeBody');
    const empty = document.getElementById('pendientes-home-empty');
    if (!tbody) return;
    tbody.innerHTML = '';
    if (!window.CARITAS?.supabase){ if (empty) empty.style.display='block'; return; }
    try {
      const { data, error } = await window.CARITAS.supabase
        .from('pendientes')
        .select('descripcion, estado')
        .order('id', { ascending: true });
      if (error) throw error;
      if (!data || data.length===0){ if(empty) empty.style.display='block'; return; }
      if (empty) empty.style.display='none';
      data.forEach(p => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${(p.descripcion||'').replace(/</g,'&lt;')} â¤ï¸</td><td>${p.estado ? 'âœ”ï¸ Hecho' : 'â³ Pendiente'}</td>`;
        tbody.appendChild(tr);
      });
    } catch(err){ console.error('Pendientes(home) error:', err); if(empty) empty.style.display='block'; }
  }
  renderPendientesHome();

  document.dispatchEvent(new CustomEvent('caritas:inicio:ready'));
})();
</script>